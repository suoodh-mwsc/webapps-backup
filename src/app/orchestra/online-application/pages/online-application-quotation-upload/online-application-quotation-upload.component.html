<!-- Search Completed Applications | with SalesOrderNo -->
<section>
  <div class="card card-main-1 sm-12">
    <div class="card-header text-primary-500 bg-primary-100 font-weight-bold">
      <div class="row">
        <div class="col-sm-6">
          Completed Applications
        </div>
        <div class="col-sm-6">
          <div class="btn-custom">
            <a class="btn-custom" (click)="viewPendingApplicationList()"><i
                class="fa fa-refresh fa-lg fa-pull-right fa-border" aria-hidden="true"></i></a>
          </div>
        </div>
      </div>
    </div>
    <div class="card-body">
      <div class="row">
        <div class="col-sm-12">
          <form>
            <div class="form-group row">
              <div class="col-sm-4">
                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <span class="input-group-text">Sales Order No</span>
                  </div>
                  <input type="number" class="form-control" [(ngModel)]="searchSalesOrderNo" name="searchSalesOrderNo"
                    id="searchSalesOrderNo" aria-label="With textarea">
                </div>
              </div>
              <div class="col-sm-4">
                <button type="button" class="btn btn-success" [disabled]="!searchSalesOrderNo"
                  (click)="searchCompletedOnlineApplicationsBySalesOrderNo(searchSalesOrderNo)"><i class="fa fa-search"
                    aria-hidden="true"></i> Search For Application</button>
              </div>
              <div class="col-sm-4">
              </div>
            </div>
          </form>
        </div>
      </div>



      <div class="row">
        <div class="col-sm-12" *ngIf="showLoader">
          <app-online-application-loader *ngIf="showLoader"></app-online-application-loader>
        </div>
        <div class="col-sm-12" *ngIf="!showLoader && selectedApplications">
          <!-- Pending Applications | Select Application -->
          <section>
            <div class="card card card-main-3 sm-12" *ngFor="let selectedApplication of selectedApplications">
              <div class="card-body">
                <!-- <div>Search Result for Sales Order No : {{searchSalesOrderNo}}</div> -->
                <h3 class="application-title-main-1">{{selectedApplication?.ApplicationType.Description}}</h3>
                <!-- Application Details -->
                <div class="row application-fieldset bg-secondary">
                  <h6 class="application-legend"> Application Details</h6>
                  <div class="col-sm-12">
                    <div class="row">
                      <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                        <div class="row">
                          <div class="col-sm-12 application-label">
                            Contact Name
                          </div>
                          <div class="col-sm-12 application-text">
                            {{selectedApplication.ContactName}}
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                        <div class="row">
                          <div class="col-sm-12 application-label">
                            Contact Number
                          </div>
                          <div class="col-sm-12 application-text">
                            {{selectedApplication.ContactNumber}}
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                        <div class="row">
                          <div class="col-sm-12 application-label">
                            Status
                          </div>
                          <div class="col-sm-12 application-text">
                            {{selectedApplication.CurrentStageDescription}}
                          </div>
                        </div>
                      </div>

                      <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                        <div class="row">
                          <div class="col-sm-12 application-label">
                            Created By
                          </div>
                          <div class="col-sm-12 application-text">
                            {{selectedApplication.CreatedBy}}
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                        <div class="row">
                          <div class="col-sm-12 application-label">
                            Created On
                          </div>
                          <div class="col-sm-12 application-text">
                            {{selectedApplication.CreatedOn  | date: 'dd/MM/yyyy hh:mm a'}}
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                        <div class="row">
                          <div class="col-sm-12 application-label">
                            Sales Order No
                          </div>
                          <div class="col-sm-12 application-text">
                            {{selectedApplication.SalesOrderNo}}
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-12 list-group-item list-group-item-action flex-column align-items-start">
                        <div class="row">
                          <div class="col-sm-12 application-label">
                            Remarks
                          </div>
                          <div class="col-sm-12 application-text">
                            {{selectedApplication.MWSCRemarks}}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Owner Details -->
                <!-- <div class="row application-fieldset bg-secondary"
                      *ngIf="selectedApplication.OwnerDetails || selectedApplication.OwnerDetails?.length > 0">
                      <h6 class="application-legend"> Owner Details</h6>
                      <div class="col-sm-12">
                        <div class="row">
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Secondary Contact
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.SecondaryContactNo}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Identification Details
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.IdentificationDetails}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Business Partner
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.BusinessPartnerId}}
                              </div>
                            </div>
                          </div>
  
                          <div class="col-sm-12">
                            <h5 class="application-subtitle-1">Permenant Address</h5>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                House Name
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.PermenantAddress.Name}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Street Name
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.PermenantAddress.Street}}
                              </div>
                            </div>
                          </div>
  
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Premise
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.PermenantAddress.Premise}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Ward
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.PermenantAddress.Ward}}
                              </div>
                            </div>
                          </div>
  
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                City
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.PermenantAddress.City}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Postal Code
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.OwnerDetails.PermenantAddress.PostalCode}}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div> -->

                <!-- Connection Details -->
                <!-- <div class="row application-fieldset bg-secondary"
                      *ngIf="selectedApplication.ConnectionDetails && selectedApplication.ConnectionDetails?.length > 0">
                      <h6 class="application-legend"> Connection Details</h6>
                      <div class="col-sm-12">
                        <div class="row">
  
                          <div class="col-sm-12 list-group-item list-group-item-action flex-column align-items-start"
                            style="margin-top: 10px;">
                            <table class="table table-striped table-hover">
                              <thead>
                                <th>AccountNo</th>
                                <th>MeterNo</th>
                                <th>Address</th>
                              </thead>
                              <tr *ngFor="let connectionDetail of selectedApplication.ConnectionDetails">
                                <td>{{connectionDetail.AccountNo}}</td>
                                <td>{{connectionDetail.MeterNo}}</td>
                                <td>{{connectionDetail.Address}}</td>
                              </tr>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div> -->

                <!-- New Connection Details -->
                <!-- <div class="row application-fieldset bg-secondary"
                      *ngIf="selectedApplication.NewConnectionDetails || selectedApplication.NewConnectionDetails?.length > 0">
                      <h6 class="application-legend"> New Connection Details</h6>
                      <div class="col-sm-12">
                        <div class="row">
                          <div class="col-sm-12 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Service Category
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.ServiceCategoryDescription}}
                              </div>
                            </div>
                          </div>
  
                          <div class="col-sm-12" style="margin-top:14px;">
                            <h5 class="application-subtitle-1">Service Required Location</h5>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                House Name
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.ServiceRequiredLocation.Name}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Street Name
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.ServiceRequiredLocation.Street}}
                              </div>
                            </div>
                          </div>
  
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Premise
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.ServiceRequiredLocation.Premise}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Ward
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.ServiceRequiredLocation.Ward}}
                              </div>
                            </div>
                          </div>
  
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                City
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.ServiceRequiredLocation.City}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                PostalCode
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.ServiceRequiredLocation.PostalCode}}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
  
                      <div class="col-sm-12">
                        <div class="row">
                          <div class="col-sm-12" style="margin-top:14px;">
                            <h5 class="application-subtitle-1">Billing Address</h5>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                House Name
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.BillingAddress.Name}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Street Name
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.BillingAddress.Street}}
                              </div>
                            </div>
                          </div>
  
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Premise
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.BillingAddress.Premise}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Ward
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.BillingAddress.Ward}}
                              </div>
                            </div>
                          </div>
  
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                City
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.BillingAddress.City}}
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 list-group-item list-group-item-action flex-column align-items-start">
                            <div class="row">
                              <div class="col-sm-12 application-label">
                                Postal Code
                              </div>
                              <div class="col-sm-12 application-text">
                                {{selectedApplication.NewConnectionDetails.BillingAddress.PostalCode}}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div> -->

                <!-- Documents Details -->
                <div class="row application-fieldset bg-secondary"
                  *ngIf="selectedApplication.Documents && selectedApplication.Documents?.length > 0">
                  <h6 class="application-legend"> Documents Details</h6>
                  <div class="col-sm-12" style="padding-left:0px; padding-right:0px;"
                    *ngIf="selectedApplication.Documents?.length > 0">
                    <div class="flex-container application-documents-flex-container">
                      <div *ngFor="let document of selectedApplication.Documents">
                        <div class="list-group-item application-documents-list-group-item">
                          <a class="col-sm-2" [href]="document.SafeFile" download="{{ document.File.FileName}}"
                            title="{{document.File.FileName}}" style="margin:0px; padding:0px;">
                            <div class="row" style="margin:0px; padding:0px;">
                              <div class="col-sm-12 application-documents-download-icon">
                                <i class="fa fa-file-pdf-o fa-3x text-secondary" aria-hidden="true"></i>
                              </div>
                              <div class="col-sm-12 application-documents-download-filename text-truncate">
                                {{document.File.FileName}}
                              </div>
                            </div>
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Quotation Details -->
                <!-- <div class="row application-fieldset bg-secondary"
                  *ngIf="selectedApplication.Quotation && selectedApplication.Quotation?.File">
                  <h6 class="application-legend"> Quotation Details</h6>
                  <div class="col-sm-12" style="padding-left:0px; padding-right:0px;"
                    *ngIf="selectedApplication.Quotation?.File">
                    <div class="flex-container application-documents-flex-container">
                      <div class="list-group-item application-documents-list-group-item">
                        <a class="col-sm-2" [href]="Quotation?.File.SafeFile" download="{{Quotation.File.FileName}}"
                          title="{{Quotation.File.FileName}}" style="margin:0px; padding:0px;">
                          <div class="row" style="margin:0px; padding:0px;">
                            <div class="col-sm-12 application-documents-download-icon">
                              <i class="fa fa-file-pdf-o fa-3x text-secondary" aria-hidden="true"></i>
                            </div>
                            <div class="col-sm-12 application-documents-download-filename text-truncate">
                              {{Quotation.File.FileName}}
                            </div>
                          </div>
                        </a>
                      </div>
                    </div>
                  </div>
                </div> -->

                <!-- Upload Quotation -->
                <div class="row application-fieldset bg-secondary">
                  <h6 class="application-legend"> Upload Quotation</h6>
                  <div class="col-sm-12">
                    <div class="row">
                      <!-- <div class="col-sm-6 list-group-item list-group-item-action flex-column align-items-start"> -->
                      <div class="col-sm-12 list-group-item flex-column align-items-start">
                        <form>
                          <input type="file" (change)="fileChange($event, selectedApplication)"
                            placeholder="Upload file" name="UploadedFile" accept=".png,.jpg,.jpeg">
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>
</section>
