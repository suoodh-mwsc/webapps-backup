{"remainingRequest":"D:\\Code MWSC\\2020-MWSC-Github\\webapps\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js??ref--3-1!D:\\Code MWSC\\2020-MWSC-Github\\webapps\\node_modules\\adal-angular5\\adal5.service.js","dependencies":[{"path":"D:\\Code MWSC\\2020-MWSC-Github\\webapps\\node_modules\\adal-angular5\\adal5.service.js","mtime":1517209170000},{"path":"D:\\Code MWSC\\2020-MWSC-Github\\webapps\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1614055079483},{"path":"D:\\Code MWSC\\2020-MWSC-Github\\webapps\\node_modules\\@angular-devkit\\build-optimizer\\src\\build-optimizer\\webpack-loader.js","mtime":1519266497000}],"contextDependencies":[],"result":["\"use strict\";\nvar __decorate = /*@__PURE__*/ require(\"tslib\").__decorate;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar adalLib = require(\"adal-angular\");\nvar core_1 = require(\"@angular/core\");\nvar Rx_1 = require(\"rxjs/Rx\");\n/**\n *\n *\n * @export\n * @class Adal5Service\n */\nvar Adal5Service = /*@__PURE__*/ (function () {\n    /**\n     * Creates an instance of Adal5Service.\n     *\n     * @memberOf Adal5Service\n     */\n    function Adal5Service() {\n        /**\n         *\n         *\n         * @private\n         * @type {Adal5User}\n         * @memberOf Adal5Service\n         */\n        this.adal5User = {\n            authenticated: false,\n            username: '',\n            error: '',\n            token: '',\n            profile: {}\n        };\n    }\n    /**\n     *\n     *\n     * @param {adal.Config} configOptions\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.init = function (configOptions) {\n        if (!configOptions) {\n            throw new Error('You must set config, when calling init.');\n        }\n        // redirect and logout_redirect are set to current location by default\n        var existingHash = window.location.hash;\n        var pathDefault = window.location.href;\n        if (existingHash) {\n            pathDefault = pathDefault.replace(existingHash, '');\n        }\n        configOptions.redirectUri = configOptions.redirectUri || pathDefault;\n        configOptions.postLogoutRedirectUri = configOptions.postLogoutRedirectUri || pathDefault;\n        // create instance with given config\n        this.adalContext = adalLib.inject(configOptions);\n        window.AuthenticationContext = this.adalContext.constructor;\n        // loginresource is used to set authenticated status\n        this.updateDataFromCache(this.adalContext.config.loginResource);\n    };\n    Object.defineProperty(Adal5Service.prototype, \"config\", {\n        /**\n         *\n         *\n         * @readonly\n         * @type {adal.Config}\n         * @memberOf Adal5Service\n         */\n        get: function () {\n            return this.adalContext.config;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Adal5Service.prototype, \"userInfo\", {\n        /**\n         *\n         *\n         * @readonly\n         * @type {Adal5User}\n         * @memberOf Adal5Service\n         */\n        get: function () {\n            return this.adal5User;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.login = function () {\n        this.adalContext.login();\n    };\n    /**\n     *\n     *\n     * @returns {boolean}\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.loginInProgress = function () {\n        return this.adalContext.loginInProgress();\n    };\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.logOut = function () {\n        this.adalContext.logOut();\n    };\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.handleWindowCallback = function () {\n        var hash = window.location.hash;\n        if (this.adalContext.isCallback(hash)) {\n            var requestInfo = this.adalContext.getRequestInfo(hash);\n            this.adalContext.saveTokenFromHash(requestInfo);\n            if (requestInfo.requestType === this.adalContext.REQUEST_TYPE.LOGIN) {\n                this.updateDataFromCache(this.adalContext.config.loginResource);\n            }\n            else if (requestInfo.requestType === this.adalContext.REQUEST_TYPE.RENEW_TOKEN) {\n                this.adalContext.callback = window.parent.callBackMappedToRenewStates[requestInfo.stateResponse];\n            }\n            if (requestInfo.stateMatch) {\n                if (typeof this.adalContext.callback === 'function') {\n                    if (requestInfo.requestType === this.adalContext.REQUEST_TYPE.RENEW_TOKEN) {\n                        // Idtoken or Accestoken can be renewed\n                        if (requestInfo.parameters['access_token']) {\n                            this.adalContext.callback(this.adalContext._getItem(this.adalContext.CONSTANTS.STORAGE.ERROR_DESCRIPTION), requestInfo.parameters['access_token']);\n                        }\n                        else if (requestInfo.parameters['error']) {\n                            this.adalContext.callback(this.adalContext._getItem(this.adalContext.CONSTANTS.STORAGE.ERROR_DESCRIPTION), null);\n                            this.adalContext._renewFailed = true;\n                        }\n                    }\n                }\n            }\n        }\n        // Remove hash from url\n        if (window.location.hash) {\n            window.location.href = window.location.href.replace(window.location.hash, '');\n        }\n    };\n    /**\n     *\n     *\n     * @param {string} resource\n     * @returns {string}\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.getCachedToken = function (resource) {\n        return this.adalContext.getCachedToken(resource);\n    };\n    /**\n     *\n     *\n     * @param {string} resource\n     * @returns\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.acquireToken = function (resource) {\n        var _this = this; // save outer this for inner function\n        var errorMessage;\n        return Rx_1.Observable.bindCallback(acquireTokenInternal, function (token) {\n            if (!token && errorMessage) {\n                throw (errorMessage);\n            }\n            return token;\n        })();\n        function acquireTokenInternal(cb) {\n            var s = null;\n            _this.adalContext.acquireToken(resource, function (error, tokenOut) {\n                if (error) {\n                    _this.adalContext.error('Error when acquiring token for resource: ' + resource, error);\n                    errorMessage = error;\n                    cb(null);\n                }\n                else {\n                    cb(tokenOut);\n                    s = tokenOut;\n                }\n            });\n            return s;\n        }\n    };\n    /**\n     *\n     *\n     * @returns {Observable<adal.User>}\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.getUser = function () {\n        var _this = this;\n        return Rx_1.Observable.bindCallback(function (cb) {\n            _this.adalContext.getUser(function (error, user) {\n                if (error) {\n                    this.adalContext.error('Error when getting user', error);\n                    cb(null);\n                }\n                else {\n                    cb(user);\n                }\n            });\n        })();\n    };\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.clearCache = function () {\n        this.adalContext.clearCache();\n    };\n    /**\n     *\n     *\n     * @param {string} resource\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.clearCacheForResource = function (resource) {\n        this.adalContext.clearCacheForResource(resource);\n    };\n    /**\n     *\n     *\n     * @param {string} message\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.info = function (message) {\n        this.adalContext.info(message);\n    };\n    /**\n     *\n     *\n     * @param {string} message\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.verbose = function (message) {\n        this.adalContext.verbose(message);\n    };\n    /**\n     *\n     *\n     * @param {string} url\n     * @returns {string}\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.GetResourceForEndpoint = function (url) {\n        return this.adalContext.getResourceForEndpoint(url);\n    };\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.refreshDataFromCache = function () {\n        this.updateDataFromCache(this.adalContext.config.loginResource);\n    };\n    /**\n     *\n     *\n     * @private\n     * @param {string} resource\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.updateDataFromCache = function (resource) {\n        var token = this.adalContext.getCachedToken(resource);\n        this.adal5User.authenticated = token !== null && token.length > 0;\n        var user = this.adalContext.getCachedUser() || { userName: '', profile: undefined };\n        if (user) {\n            this.adal5User.username = user.userName;\n            this.adal5User.profile = user.profile;\n            this.adal5User.token = token;\n            this.adal5User.error = this.adalContext.getLoginError();\n        }\n        else {\n            this.adal5User.username = '';\n            this.adal5User.profile = {};\n            this.adal5User.token = '';\n            this.adal5User.error = '';\n        }\n    };\n    ;\n    Adal5Service = __decorate([\n        core_1.Injectable()\n    ], Adal5Service);\n    return Adal5Service;\n}());\nexports.Adal5Service = Adal5Service;\n\n",{"version":3,"file":"D:\\Code MWSC\\2020-MWSC-Github\\webapps\\node_modules\\adal-angular5\\adal5.service.js.post-build-optimizer.js","sourceRoot":"","sources":["D:\\Code MWSC\\2020-MWSC-Github\\webapps\\node_modules\\adal-angular5\\adal5.service.js.pre-build-optimizer.js"],"names":[],"mappings":"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","sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar adalLib = require(\"adal-angular\");\nvar core_1 = require(\"@angular/core\");\nvar Rx_1 = require(\"rxjs/Rx\");\n/**\n *\n *\n * @export\n * @class Adal5Service\n */\nvar Adal5Service = (function () {\n    /**\n     * Creates an instance of Adal5Service.\n     *\n     * @memberOf Adal5Service\n     */\n    function Adal5Service() {\n        /**\n         *\n         *\n         * @private\n         * @type {Adal5User}\n         * @memberOf Adal5Service\n         */\n        this.adal5User = {\n            authenticated: false,\n            username: '',\n            error: '',\n            token: '',\n            profile: {}\n        };\n    }\n    /**\n     *\n     *\n     * @param {adal.Config} configOptions\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.init = function (configOptions) {\n        if (!configOptions) {\n            throw new Error('You must set config, when calling init.');\n        }\n        // redirect and logout_redirect are set to current location by default\n        var existingHash = window.location.hash;\n        var pathDefault = window.location.href;\n        if (existingHash) {\n            pathDefault = pathDefault.replace(existingHash, '');\n        }\n        configOptions.redirectUri = configOptions.redirectUri || pathDefault;\n        configOptions.postLogoutRedirectUri = configOptions.postLogoutRedirectUri || pathDefault;\n        // create instance with given config\n        this.adalContext = adalLib.inject(configOptions);\n        window.AuthenticationContext = this.adalContext.constructor;\n        // loginresource is used to set authenticated status\n        this.updateDataFromCache(this.adalContext.config.loginResource);\n    };\n    Object.defineProperty(Adal5Service.prototype, \"config\", {\n        /**\n         *\n         *\n         * @readonly\n         * @type {adal.Config}\n         * @memberOf Adal5Service\n         */\n        get: function () {\n            return this.adalContext.config;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Adal5Service.prototype, \"userInfo\", {\n        /**\n         *\n         *\n         * @readonly\n         * @type {Adal5User}\n         * @memberOf Adal5Service\n         */\n        get: function () {\n            return this.adal5User;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.login = function () {\n        this.adalContext.login();\n    };\n    /**\n     *\n     *\n     * @returns {boolean}\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.loginInProgress = function () {\n        return this.adalContext.loginInProgress();\n    };\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.logOut = function () {\n        this.adalContext.logOut();\n    };\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.handleWindowCallback = function () {\n        var hash = window.location.hash;\n        if (this.adalContext.isCallback(hash)) {\n            var requestInfo = this.adalContext.getRequestInfo(hash);\n            this.adalContext.saveTokenFromHash(requestInfo);\n            if (requestInfo.requestType === this.adalContext.REQUEST_TYPE.LOGIN) {\n                this.updateDataFromCache(this.adalContext.config.loginResource);\n            }\n            else if (requestInfo.requestType === this.adalContext.REQUEST_TYPE.RENEW_TOKEN) {\n                this.adalContext.callback = window.parent.callBackMappedToRenewStates[requestInfo.stateResponse];\n            }\n            if (requestInfo.stateMatch) {\n                if (typeof this.adalContext.callback === 'function') {\n                    if (requestInfo.requestType === this.adalContext.REQUEST_TYPE.RENEW_TOKEN) {\n                        // Idtoken or Accestoken can be renewed\n                        if (requestInfo.parameters['access_token']) {\n                            this.adalContext.callback(this.adalContext._getItem(this.adalContext.CONSTANTS.STORAGE.ERROR_DESCRIPTION), requestInfo.parameters['access_token']);\n                        }\n                        else if (requestInfo.parameters['error']) {\n                            this.adalContext.callback(this.adalContext._getItem(this.adalContext.CONSTANTS.STORAGE.ERROR_DESCRIPTION), null);\n                            this.adalContext._renewFailed = true;\n                        }\n                    }\n                }\n            }\n        }\n        // Remove hash from url\n        if (window.location.hash) {\n            window.location.href = window.location.href.replace(window.location.hash, '');\n        }\n    };\n    /**\n     *\n     *\n     * @param {string} resource\n     * @returns {string}\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.getCachedToken = function (resource) {\n        return this.adalContext.getCachedToken(resource);\n    };\n    /**\n     *\n     *\n     * @param {string} resource\n     * @returns\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.acquireToken = function (resource) {\n        var _this = this; // save outer this for inner function\n        var errorMessage;\n        return Rx_1.Observable.bindCallback(acquireTokenInternal, function (token) {\n            if (!token && errorMessage) {\n                throw (errorMessage);\n            }\n            return token;\n        })();\n        function acquireTokenInternal(cb) {\n            var s = null;\n            _this.adalContext.acquireToken(resource, function (error, tokenOut) {\n                if (error) {\n                    _this.adalContext.error('Error when acquiring token for resource: ' + resource, error);\n                    errorMessage = error;\n                    cb(null);\n                }\n                else {\n                    cb(tokenOut);\n                    s = tokenOut;\n                }\n            });\n            return s;\n        }\n    };\n    /**\n     *\n     *\n     * @returns {Observable<adal.User>}\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.getUser = function () {\n        var _this = this;\n        return Rx_1.Observable.bindCallback(function (cb) {\n            _this.adalContext.getUser(function (error, user) {\n                if (error) {\n                    this.adalContext.error('Error when getting user', error);\n                    cb(null);\n                }\n                else {\n                    cb(user);\n                }\n            });\n        })();\n    };\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.clearCache = function () {\n        this.adalContext.clearCache();\n    };\n    /**\n     *\n     *\n     * @param {string} resource\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.clearCacheForResource = function (resource) {\n        this.adalContext.clearCacheForResource(resource);\n    };\n    /**\n     *\n     *\n     * @param {string} message\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.info = function (message) {\n        this.adalContext.info(message);\n    };\n    /**\n     *\n     *\n     * @param {string} message\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.verbose = function (message) {\n        this.adalContext.verbose(message);\n    };\n    /**\n     *\n     *\n     * @param {string} url\n     * @returns {string}\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.GetResourceForEndpoint = function (url) {\n        return this.adalContext.getResourceForEndpoint(url);\n    };\n    /**\n     *\n     *\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.refreshDataFromCache = function () {\n        this.updateDataFromCache(this.adalContext.config.loginResource);\n    };\n    /**\n     *\n     *\n     * @private\n     * @param {string} resource\n     *\n     * @memberOf Adal5Service\n     */\n    Adal5Service.prototype.updateDataFromCache = function (resource) {\n        var token = this.adalContext.getCachedToken(resource);\n        this.adal5User.authenticated = token !== null && token.length > 0;\n        var user = this.adalContext.getCachedUser() || { userName: '', profile: undefined };\n        if (user) {\n            this.adal5User.username = user.userName;\n            this.adal5User.profile = user.profile;\n            this.adal5User.token = token;\n            this.adal5User.error = this.adalContext.getLoginError();\n        }\n        else {\n            this.adal5User.username = '';\n            this.adal5User.profile = {};\n            this.adal5User.token = '';\n            this.adal5User.error = '';\n        }\n    };\n    ;\n    Adal5Service = __decorate([\n        core_1.Injectable()\n    ], Adal5Service);\n    return Adal5Service;\n}());\nexports.Adal5Service = Adal5Service;\n"]}]}